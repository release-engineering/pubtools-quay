<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Security manifest pusher &mdash; pubtools-quay 0.12.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tag Docker" href="tag_docker.html" />
    <link rel="prev" title="Signer Wrapper" href="signer_wrapper.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pubtools-quay
          </a>
              <div class="version">
                0.12.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="entrypoints_reference.html">Entrypoints reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules_reference.html">Modules reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="command_executor.html">Command Executor</a></li>
<li class="toctree-l2"><a class="reference internal" href="container_image_pusher.html">Container image pusher</a></li>
<li class="toctree-l2"><a class="reference internal" href="iib_operations.html">IIB operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_untagger.html">Image untagger</a></li>
<li class="toctree-l2"><a class="reference internal" href="manifest_list_merger.html">Manifest list merger</a></li>
<li class="toctree-l2"><a class="reference internal" href="operator_pusher.html">Operator Pusher</a></li>
<li class="toctree-l2"><a class="reference internal" href="push_docker.html">Push Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="quay_api_client.html">Quay API Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="quay_client.html">Quay Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="quay_session.html">Quay Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="item_processor.html">Item Processor</a></li>
<li class="toctree-l2"><a class="reference internal" href="signer_wrapper.html">Signer Wrapper</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Security manifest pusher</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.__init__"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_get_security_manifest"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.cosign_get_security_manifest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_get_existing_attestation"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.cosign_get_existing_attestation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_attest_security_manifest"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.cosign_attest_security_manifest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_triangulate_image"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.cosign_triangulate_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_security_manifest_from_attestation"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.get_security_manifest_from_attestation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.security_manifest_get_products"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.security_manifest_get_products()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_destination_repos"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.get_destination_repos()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.delete_existing_attestation"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.delete_existing_attestation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.security_manifest_add_products"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.security_manifest_add_products()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_source_item_security_manifests"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.get_source_item_security_manifests()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_multiarch_item_security_manifests"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.get_multiarch_item_security_manifests()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.push_item_security_manifests"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.push_item_security_manifests()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.push_security_manifests"><code class="docutils literal notranslate"><span class="pre">SecurityManifestPusher.push_security_manifests()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tag_docker.html">Tag Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">ChangeLog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pubtools-quay</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules_reference.html">Modules reference</a></li>
      <li class="breadcrumb-item active">Security manifest pusher</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/security_manifest_pusher.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-pubtools._quay.security_manifest_pusher">
<span id="security-manifest-pusher"></span><h1>Security manifest pusher<a class="headerlink" href="#module-pubtools._quay.security_manifest_pusher" title="Permalink to this heading"></a></h1>
<p>Class used for creating and pushing container security manifests in the form of attestations. THe manifests are extracted from a pushed image, and the product name is added as a metadata. If there is an already existing security manifest, multiple product names can be merged.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pubtools._quay.security_manifest_pusher.</span></span><span class="sig-name descname"><span class="pre">SecurityManifestPusher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">push_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher" title="Permalink to this definition"></a></dt>
<dd><p>Class that pushes container security manifests.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">push_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>push_items ([ContainerPushItem]):</dt><dd><p>List of push items.</p>
</dd>
<dt>target_settings (dict):</dt><dd><p>Target settings.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_get_security_manifest">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cosign_get_security_manifest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.cosign_get_security_manifest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_get_security_manifest" title="Permalink to this definition"></a></dt>
<dd><p>Use cosign to get security manifest from an image and save it to a file.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>image_ref (str):</dt><dd><p>Image reference to get the manifest from.</p>
</dd>
<dt>output_file (str):</dt><dd><p>File where to save the manifest.</p>
</dd>
</dl>
</dd>
<dt>Returns (bool):</dt><dd><p>Whether the manifest was gathered successfully (True) or not (False).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_get_existing_attestation">
<span class="sig-name descname"><span class="pre">cosign_get_existing_attestation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rekor_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_verify_rekor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.cosign_get_existing_attestation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_get_existing_attestation" title="Permalink to this definition"></a></dt>
<dd><p>Use cosign to verify and get an attestation, if it exists.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>image_ref (str):</dt><dd><p>Image reference to get the manifest from.</p>
</dd>
<dt>output_file (str):</dt><dd><p>File where to save the attestation.</p>
</dd>
<dt>rekor_url (str):</dt><dd><p>URL of the rekor instance to use. If unset, default will be used.</p>
</dd>
<dt>skip_verify_rekor (bool):</dt><dd><p>Whether to skip rekor log verification. This option is recommended for when an
attestation was created without uploading a transparency log to rekor. rekor_url
parameter is ignored if this option is enabled.</p>
</dd>
</dl>
</dd>
<dt>Returns (bool):</dt><dd><p>Whether the attestation was gathered successfully (True) or not (False).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_attest_security_manifest">
<span class="sig-name descname"><span class="pre">cosign_attest_security_manifest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">security_manifest_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rekor_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_upload_rekor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.cosign_attest_security_manifest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_attest_security_manifest" title="Permalink to this definition"></a></dt>
<dd><p>Use cosign to attest a security manifest and push the created image to the destination.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>security_manifest_path (str):</dt><dd><p>Path to the security manifest.</p>
</dd>
<dt>image_ref (str):</dt><dd><p>Image to which the security manifest should be attested to.</p>
</dd>
<dt>rekor_url (str):</dt><dd><p>URL of the rekor instance to use. If unset, default will be used.</p>
</dd>
<dt>skip_upload_rekor (bool):</dt><dd><p>Whether to skip uploading transparency log to rekor. rekor_url parameter is ignored
if this option is enabled.</p>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>RuntimeError:</dt><dd><p>If the command fails.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_triangulate_image">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cosign_triangulate_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'attestation'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.cosign_triangulate_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.cosign_triangulate_image" title="Permalink to this definition"></a></dt>
<dd><p>Use cosign to get the reference to the attestation image.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>image_ref (str):</dt><dd><p>Image whose attestation image reference to get.</p>
</dd>
<dt>dir_path (str):</dt><dd><p>Path where a file containing the reference should be created.</p>
</dd>
<dt>image_type (str):</dt><dd><p>Type of image being triangulated.</p>
</dd>
</dl>
</dd>
<dt>Returns (str):</dt><dd><p>Reference of the attestation image.</p>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>RuntimeError:</dt><dd><p>If the command fails.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_security_manifest_from_attestation">
<span class="sig-name descname"><span class="pre">get_security_manifest_from_attestation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.get_security_manifest_from_attestation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_security_manifest_from_attestation" title="Permalink to this definition"></a></dt>
<dd><p>Parse image attestation and extract a security manifest.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>file_path (str):</dt><dd><p>Path of a file containing the attestation.</p>
</dd>
</dl>
</dd>
<dt>Returns (dict):</dt><dd><p>Parsed attestation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.security_manifest_get_products">
<span class="sig-name descname"><span class="pre">security_manifest_get_products</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">security_manifest</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.security_manifest_get_products"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.security_manifest_get_products" title="Permalink to this definition"></a></dt>
<dd><p>Get a list of products from an already uploaded security manifest.</p>
<p>Products are expected to be in format:
“properties”:[
{
“name”: “product”,
“value”: “product-1”
},
{
“name”: “product”,
“value”: “product-2”
}
]</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>security_manifest (dict):</dt><dd><p>Security manifest extracted from an attestation.</p>
</dd>
</dl>
</dd>
<dt>Returns (set[str]):</dt><dd><p>List of products.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_destination_repos">
<span class="sig-name descname"><span class="pre">get_destination_repos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.get_destination_repos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_destination_repos" title="Permalink to this definition"></a></dt>
<dd><p>Get a list of destination refs (without tag/digest) of a push item.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>item (ContainerPushItem):</dt><dd><p>Push item.</p>
</dd>
</dl>
</dd>
<dt>Returns ([str]):</dt><dd><p>List of destination repositories (refs without tag/digest).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.delete_existing_attestation">
<span class="sig-name descname"><span class="pre">delete_existing_attestation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.delete_existing_attestation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.delete_existing_attestation" title="Permalink to this definition"></a></dt>
<dd><p>Delete an existing attestation image.</p>
<p>This may be necessary if a new product name is to be added to an existing security manifest.
By default, ‘cosign attest’ appends the new security manifest to the existing attestation,
making it offer two manifests instead of one. It is also unable to replace an existing
attestation by itself. So the attestation image needs to be removed manually before being
reuploaded with the complete list of products.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>image_ref (str):</dt><dd><p>Image whose attestation image should be removed.</p>
</dd>
<dt>dir_path (str):</dt><dd><p>Path to a directory where temporary files may be created.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.security_manifest_add_products">
<span class="sig-name descname"><span class="pre">security_manifest_add_products</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">security_manifest_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">products</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.security_manifest_add_products"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.security_manifest_add_products" title="Permalink to this definition"></a></dt>
<dd><p>Add product names of the shipped image to the security manifest.</p>
<p>Modified manifest will be saved to a new file in the same directory.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>security_manifest_path (str):</dt><dd><p>Path to the extracted security manifest.</p>
</dd>
<dt>products (set[str]):</dt><dd><p>Products to add to the security manifest.</p>
</dd>
</dl>
</dd>
<dt>Returns (str):</dt><dd><p>Path to a file containing the modified security manifest.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_source_item_security_manifests">
<span class="sig-name descname"><span class="pre">get_source_item_security_manifests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DigestSecurityManifest</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.get_source_item_security_manifests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_source_item_security_manifests" title="Permalink to this definition"></a></dt>
<dd><p>Get security manifest of a source image.</p>
<p>Source image has only one architecture, so at most one security manifest will be present.
Based on testing, source images don’t seem to contain security manifests, so failure to
extract it doesn’t result in an error.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>item (ContainerPushItem):</dt><dd><p>Push item of a source image.</p>
</dd>
<dt>dir_path (str):</dt><dd><p>Directory path where the manifest file should be created.</p>
</dd>
</dl>
</dd>
<dt>Returns [DigestSecurityManifest]:</dt><dd><p>Extracted security manifest.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_multiarch_item_security_manifests">
<span class="sig-name descname"><span class="pre">get_multiarch_item_security_manifests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DigestSecurityManifest</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.get_multiarch_item_security_manifests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.get_multiarch_item_security_manifests" title="Permalink to this definition"></a></dt>
<dd><p>Get security manifests of a multiarch image.</p>
<p>Each architecture has its own security manifest. Older images don’t have security manifests,
so failure to extract them doesn’t result in an error.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>item (ContainerPushItem):</dt><dd><p>Push item of a multiarch image.</p>
</dd>
<dt>dir_path (str):</dt><dd><p>Directory path where the manifest files should be created.</p>
</dd>
</dl>
</dd>
<dt>Returns [DigestSecurityManifest]:</dt><dd><p>Extracted security manifests.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.push_item_security_manifests">
<span class="sig-name descname"><span class="pre">push_item_security_manifests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.push_item_security_manifests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.push_item_security_manifests" title="Permalink to this definition"></a></dt>
<dd><p>Generate and push container security manifest images of a push item.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>item (ContainerPushItem):</dt><dd><p>Push item.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pubtools._quay.security_manifest_pusher.SecurityManifestPusher.push_security_manifests">
<span class="sig-name descname"><span class="pre">push_security_manifests</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/pubtools/_quay/security_manifest_pusher.html#SecurityManifestPusher.push_security_manifests"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pubtools._quay.security_manifest_pusher.SecurityManifestPusher.push_security_manifests" title="Permalink to this definition"></a></dt>
<dd><p>Attest and push security manifest for each push item in parallel.</p>
<p>Skopeo login is performed before the workflow is started for each push item. Cosign can
only get the credentials from the default Docker auth config file, so skopeo is used
to set the correct value. This has to be done at runtime because the credentials are
target-specific.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="signer_wrapper.html" class="btn btn-neutral float-left" title="Signer Wrapper" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tag_docker.html" class="btn btn-neutral float-right" title="Tag Docker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Red Hat.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>